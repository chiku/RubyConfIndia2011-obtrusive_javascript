<html>
<head>
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/prototype/1.6.0.2/prototype.js"></script>
  <script>function set_current_bar(a, b, c) {
    if (console)
      console.log(a, b, c);
  }
  </script>
</head>

<body>
<div id="foo_links" class="foo_links">Stuff</div>

<a class="foo_description" href="#" data-qux-id="9477" data-id="36981" data-magic="WN2-1D">
  WN2-1D - 296024
</a>

<script>
document.observe("dom:loaded", function() {
  $$(".foo_description").each(function(link) {
    var id = link.readAttribute('data-id');
    var url = '/qux/' + link.readAttribute('data-qux-id') + '/foo_links/' + id + '?kind=Baz';

    link.observe("click", function() {
      new Ajax.Updater('foo_links', url, {
        method: 'get',
        evalScripts: true
      });
      set_current_bar('Baz', id, link.readAttribute('data-magic'));
      return false;
    });
  });
});
</script>

</body>
</html>
